
<html>
<head>
    <title>NHL JSON</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <script type="text/javascript">
        $(document).ready(function(){
                $.ajax({
                    type: "GET",
                    url: "http://statsapi.web.nhl.com/api/v1/game/2016020153/feed/live/",
                    success: function(response){
                        console.log(response);
                        var plays = response.liveData.plays;
                        var awayTeamId = response.gameData.teams.away.id;
                        var homeTeamId = response.gameData.teams.home.id;
                        var awayTeamAbr = response.gameData.teams.away.abbreviation;
                        var homeTeamAbr = response.gameData.teams.home.abbreviation;

                        var homeGoals = 0;
                        var awayGoals = 0;

                        var homeShots = 0;
                        var awayShots = 0;

                        var homeCorsi = 0;
                        var awayCorsi = 0;

                        var homeBlocks = 0;
                        var awayBlocks = 0;

                        var homeHits = 0;
                        var awayHits = 0;

                        var homeGiveaways = 0;
                        var awayGiveaways = 0;

                        var homeFaceoff = 0;
                        var awayFaceoff = 0;

                        for (var i = 0; i < plays.allPlays.length; i++)
                        {
                            //console.log(plays.allPlays[i].result.description);
                            var eventType = plays.allPlays[i].result.eventTypeId;
                            if(eventType == "GOAL")
                            {
                                if(plays.allPlays[i].team.id == awayTeamId)
                                {
                                    awayGoals ++;
                                }
                                else if(plays.allPlays[i].team.id == homeTeamId)
                                {
                                    homeGoals++;
                                }
                            }
                            if(eventType == "SHOT" || eventType == "GOAL")
                            {
                                if(plays.allPlays[i].team.id == awayTeamId)
                                {
                                    awayShots ++;
                                }
                                else if(plays.allPlays[i].team.id == homeTeamId)
                                {
                                    homeShots++;
                                }
                            }
                            if(eventType == "SHOT" || eventType == "GOAL" || eventType == "MISSED_SHOT")
                            {
                                if(plays.allPlays[i].team.id == awayTeamId)
                                {
                                    awayCorsi ++;
                                }
                                else if(plays.allPlays[i].team.id == homeTeamId)
                                {
                                    homeCorsi ++;
                                }
                            }
                            if (eventType == "BLOCKED_SHOT") // Blocked shots are credited to the blocking team, so opposite Corsi needs to be added to.
                            {
                                if(plays.allPlays[i].team.id == awayTeamId)
                                {
                                    homeCorsi ++;
                                    awayBlocks ++;
                                }
                                else if(plays.allPlays[i].team.id == homeTeamId)
                                {
                                    awayCorsi ++;
                                    homeBlocks ++;
                                }
                            }
                            if(eventType == "HIT")
                            {
                                if(plays.allPlays[i].team.id == awayTeamId)
                                {
                                    awayHits ++;
                                }
                                else if(plays.allPlays[i].team.id == homeTeamId)
                                {
                                    homeHits ++;
                                }
                            }
                            if(eventType == "GIVEAWAY")
                            {
                                if(plays.allPlays[i].team.id == awayTeamId)
                                {
                                    awayGiveaways ++;
                                }
                                else if(plays.allPlays[i].team.id == homeTeamId)
                                {
                                    homeGiveaways ++;
                                }
                            }
                            if(eventType == "FACEOFF")
                            {
                                if(plays.allPlays[i].team.id == awayTeamId)
                                {
                                    awayFaceoff ++;
                                }
                                else if(plays.allPlays[i].team.id == homeTeamId)
                                {
                                    homeFaceoff ++;
                                }
                                var totalFaceoff = awayFaceoff + homeFaceoff;
                                awayFaceoffPercent = awayFaceoff/totalFaceoff;
                                homeFaceoffPercent = homeFaceoff/totalFaceoff;
                            }
                        };

                        // OUTPUT
                        console.log("Score--> " + homeTeamAbr + ":" + homeGoals + " " + awayTeamAbr + ":" + awayGoals);
                        console.log("SOG -->" + homeShots + " away: " + awayShots);
                        console.log("Corsi -->" + homeCorsi + " away: " + awayCorsi);
                        console.log("Blocks -->" + homeBlocks + " away: " + awayBlocks);
                        console.log("Hits -->" + homeHits + " away: " + awayHits);
                        console.log("Giveaways -->" + homeGiveaways + " away: " + awayGiveaways);
                        console.log("Faceoff % -->" + homeFaceoffPercent + " away: " + awayFaceoffPercent);
                        //$("#output-area").text();
                    }
                });
        });
    </script>
</head>
<body>
    <div id="output-area">

    </div>

</body>
</html>
